<?php $this->headTitle($this->translate('Project Details','Employer')) ?>
<!-- Le styles -->
<?php $this->headLink()
    ->prependStylesheet($this->basePath() . '/v2/css/plugins/datetimepicker/DateTimePicker.css')
    ->prependStylesheet($this->basePath() . '/v2/css/plugins/summernote/summernote-bs3.css')
    ->prependStylesheet($this->basePath() . '/v2/css/plugins/summernote/summernote.css')
    ->prependStylesheet($this->basePath() . '/v2/css/plugins/multiselect/bootstrap-multiselect.css')
    ->prependStylesheet($this->basePath() . '/v2/css/plugins/steps/jquery.steps.css')
?>
<!-- Scripts -->
<?php $this->headScript()
    ->prependFile($this->basePath() . '/v2/js/plugins/datetimepicker/DateTimePicker.js')
    ->prependFile($this->basePath() . '/v2/js/admin/project/project-detail.js')
    ->prependFile($this->basePath() . '/v2/js/admin/common/angular/ItemListController.js')
    ->prependFile($this->basePath() . '/v2/js/admin/common/angular/service/project.js')
    ->prependFile($this->basePath() . '/v2/js/admin/common/angular/CurrentUser.js')
    ->prependFile($this->basePath() . '/v2/js/admin/bootstrap-modal.js')
    ->prependFile($this->basePath() . '/v2/js/plugins/angular-bootstrap/ui-bootstrap-tpls-0.11.2.min.js')
    ->prependScript("angularApp = angular.module('project', ['summernote', 'angularFileUpload','ui.bootstrap']);")
    ->prependScript("PROJECT_ID = {$this->id};")
    ->prependFile($this->basePath() . '/v2/js/plugins/bootstrap-filestyle/bootstrap-filestyle.min.js')
    ->prependFile($this->basePath() . '/v2/js/plugins/angular-summernote/angular-summernote.js')
    ->prependFile($this->basePath() . '/v2/js/plugins/summernote/summernote.min.js')
    ->prependFile($this->basePath() . '/v2/js/plugins/multiselect/bootstrap-multiselect.js')
    ->prependFile($this->basePath() . '/v2/js/plugins/validate/jquery.validate.min.js')
    ->prependFile($this->basePath() . '/v2/js/plugins/slimscroll/jquery.slimscroll.min.js')
    ->prependFile($this->basePath() . '/v2/js/plugins/metisMenu/jquery.metisMenu.js"') 
    ->prependFile($this->basePath() . '/v2/js/plugins/bootbox/bootbox.min.js');
?>

<?php
$this->inlineScript()
    ->prependScript("
		var LANG_CODE = '" . $this->lang_code . "';
    ");
?>
<style>
.note-editor {
    height: 150px;
}

    .label_check label{
        margin-right: 0.3em;
    }
    
.dl-horizontal dt {
  		width: 167px;
}
    input[readonly][data-field=datetime]{
        background-color: #fff;
    }
    input[readonly][data-field=datetime]:hover,
    i.fa.fa-calendar:hover{
        cursor: pointer;
    }
</style>

                        <div class="row">

                            <div class="col-md-12">
                                <?php if (!$this->isemployer) {?>
                                <button class="btn btn-danger pull-right" ng-click="showEdit()">
                                    <i class="fa fa-edit"></i><?php echo $this->translate('Edit Project') ?>
                                </button>
                                <?php } ?>
                                <h2 class="m-b-xs"><span class="font-bold text-navy">{{ project.project_no }}</span>&nbsp;&nbsp; <span>{{ project.reference }}</span></h2>
                                <hr>
                                <div>
                                    <button class="btn btn-{{ task.status.decorator }} pull-right">{{ project.status.name }}</button>
                                    <h1 class="product-main-price">$406,602 <small class="text-muted" style="font-size: 16px;">1800 words</small> </h1>
                                </div>
                                <hr>
                                <div class="row">
                                    <div class="col-sm-6 b-r">
                                        <table class="table table-striped table-bordered">
                                            <tbody>
                                            <tr>
                                                <th><?php echo $this->translate('Due Date','Employer'); ?></th>
                                                <td> {{ formatDate(project.dueDate.date) | date:'dd MMMM yyyy - h:mm a' }} </td>
                                            </tr>
                                            <tr>
                                                <th><?php echo $this->translate('Source Language','Employer'); ?></th>
                                                <td> <code style="font-size: 14px;">{{ project.sourceLanguage.name }}</code> </td>
                                            </tr>
                                            <tr>
                                                <th><?php echo $this->translate('Project Type','Employer'); ?></th>
                                                <td>
                                                  <div class="tooltip-demo">
                                                    <span ng-repeat="type in project.types"><code style="font-size: 14px;" {{ type.inline_attrs }}>{{ type.name_short }}</code>&nbsp;</span>
                                                  </div>
                                                </td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <div class="col-sm-6">
                                        <table class="table table-striped table-bordered">
                                            <tbody>
                                            <tr>
                                                <th><?php echo $this->translate('PO No','Employer'); ?></th>
                                                <td> {{ project.po }} </td>
                                            </tr>
                                            <tr>
                                                <th><?php echo $this->translate('Languages','Employer'); ?></th>
                                                <td> <span ng-repeat="language in project.targetLanguages"><code style="font-size: 14px;">{{ language.name }}</code>&nbsp;</span> </td>
                                            </tr>
                                            <tr>
                                                <th><?php echo $this->translate('Project Manager','Employer'); ?></th>
                                                <td> {{ project.pm.name }} </td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                <?php if (!$this->isemployer) {?>
                                <div class="row">
                                    <div class="col-sm-6 b-r">
                                        <table class="table table-striped table-bordered">
                                            <tbody>
                                            <tr>
                                                <th><?php echo $this->translate('Field'); ?></th>
                                                <td> {{ project.field.name }} </td>
                                            </tr>
                                            <tr>
                                                <th><?php echo $this->translate('Client Contact'); ?></th>
                                                <td>{{ project.client.name }}</td>
                                            </tr>
                                            <tr>
                                                <th><?php echo $this->translate('Sales'); ?></th>
                                                <td class="text-navy"> {{ project.sale.name }} </td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <div class="col-sm-6">
                                        <table class="table table-striped table-bordered">
                                            <tbody>
                                            <tr>
                                                <th><?php echo $this->translate('Client Company'); ?></th>
                                                <td>{{ project.client.company.name }}</td>
                                            </tr>
                                            <tr>
                                                <th><?php echo $this->translate('Project Manager'); ?></th>
                                                <td> {{ project.pm.name }} </td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                <?php } ?>
                            </div>
                        </div>



<div ng-controller="ProjectDetailController" id="ProjectDetailController">
    <div class="wrapper wrapper-content animated fadeInRight">

        <div class="row">
            <div class="col-lg-12">

                <div class="ibox product-detail">
                    <div class="ibox-content">

                        <?php include "detail/info.phtml"; ?>
                        <?php if (!$this->isemployer) { include "detail/miniform.phtml"; } ?>

                    </div>
                </div>

            </div>
        </div>

        <div class="row">
            <div class="col-lg-12">

                <?php
                    switch($this->userData()['role']){
                        case 'Admin':
                            //staff menus here
                            switch($this->userData()['type']){
                                case 'Admin':
                                case 'Financial Manager':
                                case 'Operation Manager':
                                case 'Project Manager':
                                case 'Sales Director':
                                case 'Sales': // Sales Manager
                                case 'General Manager': // Inhouse
                                default:
                                    include "detail-common.phtml";
                            }
                            break;
                        case 'Employer': // employer == client
                        case 'Client':
                            
                            $filesTabActive = true;
                            include "detail-client.phtml";
                            break;
                        case 'Freelancer':
                        default:
                            include "detail-common.phtml";
                            // TODO: default menu
                    };
                ?>

            </div>
        </div>

    </div>
</div>

<script>
    $(document).ready(function(){
        $('.dtbox').DateTimePicker();
$('.dtbox1').DateTimePicker();

        // trigger datetime picker when click to calendar icon
        // TODO: this is not working
        $('i.fa.fa-calendar').on('click', function(e){
            console.log('clicked');
            //e.preventDefault();
			//console.log($(this).parents('.input-group').find('input[readonly]'));
            //$(this).parents('.input-group').find('input[readonly]').click();
        });
    });
</script>